<figure>
    {{ .Page.Scratch.Add "figures" 1 -}}
    {{-
        $img := (
            or (.Page.Resources.GetMatch (.Get 0)) (resources.Get (.Get 0))
        )
    -}}
    <img
        src="{{ $img.RelPermalink }}"
        alt="{{ default ($.Get 1) ($.Get 2) }}"
        {{- if eq ($.Get 3 ) true }}
            loading="eager"
        {{ else }}
            loading="lazy"
        {{- end }}
        {{- if ne $img.MediaType.SubType "svg" }}
            height="{{ $img.Height }}"
            width="{{ $img.Width }}"
        {{- end }}
    />
    <figcaption>
        {{ sub (.Page.Scratch.Get "figures") 1 }}. {{ .Get 1 | markdownify }}
    </figcaption>
</figure>
{{- "" -}}
